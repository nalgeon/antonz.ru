+++
date = 2020-06-04T14:11:07Z
description = "–û—à–∏–±–∫–∏ –≤ –≥–æ –æ—Å–æ–±–µ–Ω–Ω–æ —É—Ä–æ–¥–ª–∏–≤—ã, –Ω–æ —ç—Ç–æ –Ω–µ—Å–ø—Ä–æ—Å—Ç–∞."
image = "/assets/projects/thankgo.png"
slug = "go-errors"
tags = ["development"]
title = "–ö—Ä–∞—Å–∞–≤–∏—Ü–∞ –∏ —á—É–¥–æ–≤–∏—â–µ. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫¬†–≤¬†Go"
subscribe = "thank_go"
+++

–†–æ–± –ü–∞–π–∫ —Å–∫–∞–∑–∞–ª –æ–±¬†–æ—à–∏–±–∫–∞—Ö –≤¬†–≥–æ:

> Explicit error checking forces the programmer to think about errors ‚Äî and deal with them ‚Äî when they arise.

–≠—Ç–æ –ø—Ä–∞–≤–¥–∞. –ù–æ¬†–Ω–µ¬†–≤—Å—è.

–î–æ–ø—É—Å—Ç–∏–º, —è¬†—Ö–æ—á—É –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª –∏–∑¬†—Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞. –í–æ—Ç –∫–∞–∫ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –Ω–∞¬†–ø–∏—Ç–æ–Ω–µ:

```python
def read_numbers(filename):
    return [int(line.strip()) for line in open(filename)]
```

–ò–ª–∏, –≤¬†–±–æ–ª–µ–µ –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω–æ–º —Å—Ç–∏–ª–µ:

```python
def read_numbers(filename):
    numbers = []
    for line in open(filename):
        num = int(line.strip())
        numbers.append(num)
    return numbers
```

```python
>>> read_numbers("numbers.txt")
[11, 33, 71]
```

–ö–∞–∫–æ–π –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã–π, –ª–∞–∫–æ–Ω–∏—á–Ω—ã–π, –ø–æ–Ω—è—Ç–Ω—ã–π –∫–æ–¥, –Ω–µ¬†–ø—Ä–∞–≤–¥–∞ –ª–∏? –°–¥–µ–ª–∞–µ–º —Ç–æ¬†–∂–µ —Å–∞–º–æ–µ –≤¬†–≥–æ:

```go
func readNumbers(filename string) ([]int, error) {
	file, err := os.Open(filename)
	if err != nil {
		return nil, err
	}
	defer file.Close()

	var numbers []int
	scanner := bufio.NewScanner(file)
	for scanner.Scan() {
		number, err := strconv.Atoi(scanner.Text())
		if err != nil {
			return nil, err
		}
		numbers = append(numbers, number)
	}

	if err := scanner.Err(); err != nil {
		return nil, err
	}

	if err := file.Close(); err != nil {
		return nil, err
	}

	return numbers, nil
}
```

## –ü–ª–æ—Ö–æ / —Ö–æ—Ä–æ—à–æ

–ß—Ç–æ –ø–ª–æ—Ö–æ –≤¬†—ç—Ç–æ–º –∫–æ–¥–µ? (–ø–æ–º–∏–º–æ —Ç–æ–≥–æ, —á—Ç–æ –æ–Ω¬†–ø—Ä—è–º–æ —É–º–æ–ª—è–µ—Ç —Ä–∞–∑–±–∏—Ç—å –Ω–∞¬†–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–π –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–π –∂–∏—Ä–Ω–æ–π)

1. –û–Ω —É—Ä–æ–¥–ª–∏–≤—ã–π.
2. –¢—è–∂–µ–ª–æ –ø–æ–Ω—è—Ç—å –ø—Ä–æ–∏—Å—Ö–æ–¥—è—â–µ–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø–µ—Ä–µ–º–µ—à–∞–Ω–∞ —Å¬†–æ—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–æ–π.

–ê¬†–≤–æ—Ç —á—Ç–æ —Ö–æ—Ä–æ—à–æ:

1. –í–∏–¥–Ω—ã –≤—Å–µ —Å–∏—Ç—É–∞—Ü–∏–∏, –≤¬†–∫–æ—Ç–æ—Ä—ã—Ö —á—Ç–æ-—Ç–æ –º–æ–∂–µ—Ç –ø–æ–π—Ç–∏ –Ω–µ¬†—Ç–∞–∫.
2. –ü–æ–∫–∞ –ø–∏—à–µ—à—å –∫–æ–¥, –≥–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–µ—à–∏—Ç—å, —á—Ç–æ –¥–µ–ª–∞—Ç—å —Å¬†–∫–∞–∂–¥–æ–π –æ—à–∏–±–∫–æ–π.

–°–µ—Ä—å—ë–∑–Ω—ã–π –ø–ª—é—Å, –Ω–∞¬†—Å–∞–º–æ–º –¥–µ–ª–µ. –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ —Å–æ–∑–¥–∞—é—Ç –æ–≥—Ä–æ–º–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–≥–æ–≤ –≤¬†–ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö –Ω–∞¬†–¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–∞—Ö. –ì–æ –∂–µ —Ç—ã—á–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—É –≤¬†–ª–∏—Ü–æ –æ—à–∏–±–∫–∞–º–∏ –∏¬†—Ç—Ä–µ–±—É–µ—Ç —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å, —á—Ç–æ —Å¬†–Ω–∏–º–∏ –¥–µ–ª–∞—Ç—å.

–ù–æ¬†–≤—Å–µ–≥–¥–∞ –ª–∏ —ç—Ç–æ –ø–ª—é—Å? –û–±—ã—á–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–µ¬†—Ç–∞–º, –≥–¥–µ –æ—à–∏–±–∫–∞ –≤—ã–±—Ä–æ—à–µ–Ω–∞, –∞¬†–Ω–∞¬†–±–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ–º —É—Ä–æ–≤–Ω–µ. –ß–∞—Å—Ç–æ¬†‚Äî –Ω–∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ–º. –í¬†–≥–æ —ç—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫¬†–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º ¬´–ø—Ä–æ–±—Ä–æ—Å–∞–º¬ª –æ—à–∏–±–æ–∫ –Ω–∞–≤–µ—Ä—Ö:

```go
if err != nil {
    return err
}
```

–¢–∞–∫–æ–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∞ –ª—é–±–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–∞¬†–≥–æ. –¶–µ–Ω–Ω–æ—Å—Ç—å –µ—ë¬†–Ω—É–ª–µ–≤–∞—è, –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ —á–∏—Å—Ç–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –æ—à–∏–±–∫–∏ –≤—ã—à–µ, –≤—ã—à–µ –∏¬†–≤—ã—à–µ¬†‚Äî –¥–æ¬†–º–æ–º–µ–Ω—Ç–∞, –∫–æ–≥–¥–∞ –æ–Ω–∞ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞.

–í¬†—è–∑—ã–∫–∞—Ö —Å¬†–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π `try-catch` —Ç–∞–∫–æ–π –∫–æ—Å—Ç—ã–ª—å –Ω–µ¬†–Ω—É–∂–µ–Ω¬†‚Äî –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å `catch` –Ω–∞¬†—Ç–æ–º —É—Ä–æ–≤–Ω–µ, –≥–¥–µ –æ—à–∏–±–∫–∞ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞. –ü—Ä–∏ —ç—Ç–æ–º –Ω–∞¬†–±–æ–ª–µ–µ –Ω–∏–∑–∫–∏—Ö —É—Ä–æ–≤–Ω—è—Ö –º–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å –∫–æ–¥ —Ç–∞–∫, –∫–∞–∫ –±—É–¥—Ç–æ –Ω–∏–∫–∞–∫–∏—Ö –æ—à–∏–±–æ–∫ –Ω–µ—Ç¬†‚Äî —ç—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É –ø—Ä–æ—â–µ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∏¬†–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏.

–ù–∞¬†–ø–∏—Ç–æ–Ω–µ —è¬†–º–æ–≥—É —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫:

```python
try:
    numbers = read_numbers("numbers.txt")
except Exception as exc:
    print(f"Failed to read numbers: {exc}")
```

–ò¬†–Ω–µ¬†–∑–∞–±–æ—Ç–∏—Ç—å—Å—è –≤–Ω—É—Ç—Ä–∏ `read_numbers()` –æ–±¬†–æ–±—Ä–∞–±–æ—Ç–∫–µ –æ—à–∏–±–æ–∫. –ï—Å–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ –æ—à–∏–±–∫–∏ –Ω–µ¬†–≤–∞–∂–Ω–∞, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥.

–ì–æ¬†–∂–µ¬†–≤—ã–Ω—É–∂–¥–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞ –≤–æ–∑–∏—Ç—å—Å—è —Å¬†–∫–∞–∂–¥–æ–π –æ—à–∏–±–∫–æ–π¬†‚Äî –¥–∞–∂–µ –∫–æ–≥–¥–∞ –Ω–µ¬†–Ω–∞–¥–æ. –†–æ–± –ü–∞–π–∫ —Å–¥–µ–ª–∞–ª –≤—ã–±–æ—Ä –∑–∞¬†–≤–∞—Å, –∂–∏–≤–∏—Ç–µ —Å¬†—ç—Ç–∏–º.

## –ß—Ç–æ –¥–∞–ª—å—à–µ

–î—É–º–∞—é, –∞–≤—Ç–æ—Ä—ã —è–∑—ã–∫–∞ –ø–æ–Ω–∏–º–∞–ª–∏ –ª—É–∫–∞–≤—Å—Ç–≤–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π –æ¬†–≤–µ–ª–∏–∫–æ–ª–µ–ø–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –≤ –≥–æ. –ò–º–µ–Ω–Ω–æ —ç—Ç–∏–º –º–æ–∂–Ω–æ –æ–±—ä—è—Å–Ω–∏—Ç—å –∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–æ–±–∞–≤–∏—Ç—å –≤¬†Go¬†1.14 <a href="https://github.com/golang/go/issues/32437">—Ñ—É–Ω–∫—Ü–∏—é try</a>.

–í–º–µ—Å—Ç–æ:

```go
f, err := os.Open(filename)
if err != nil {
	return ..., err
}
```

–ú–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –ø–∏—Å–∞—Ç—å —Ç–∞–∫:

```go
f := try(os.Open(filename))
```

–°–ª–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å —Å–µ–±–µ –±–æ–ª–µ–µ —É–∂–∞—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ. –û–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–≤—ã—à–∞–µ—Ç —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –∫–æ–¥–∞, –Ω–æ¬†–ø–æ–ª–Ω–æ—Å—Ç—å—é —É–±–∏–≤–∞–µ—Ç —Ç–æ¬†–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ, —á—Ç–æ –µ—Å—Ç—å —Ö–æ—Ä–æ—à–µ–≥–æ –≤¬†—Ä–∞–±–æ—Ç–µ —Å¬†–æ—à–∏–±–∫–∞–º–∏ –≤¬†–≥–æ¬†‚Äî —Ç–æ—Ç —Å–∞–º—ã–π ¬´explicit error checking¬ª, –∫–æ—Ç–æ—Ä—ã–π ¬´forces the programmer to think about errors¬ª.

–ö¬†—Å—á–∞—Å—Ç—å—é, –≤–æ–ª–Ω–∞ –Ω–µ–¥–æ—É–º–µ–Ω–∏—è –æ—Ç¬†—Å–æ–æ–±—â–µ—Å—Ç–≤–∞ –∑–∞—Å—Ç–∞–≤–∏–ª–∞ –∞–≤—Ç–æ—Ä–æ–≤ –ø–µ—Ä–µ–¥—É–º–∞—Ç—å:

> We still believe that error handling in Go is not perfect and can be meaningfully improved, but it is clear that we as a community need to talk more about what specific aspects of error handling are problems that we should address.

–ê–º–∏–Ω—å.

P.S. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è:

<div class="row">
<div class="col-xs-12 col-sm-6">
<figure>
  <a href="tg://resolve?domain=thank_go&post=20"><img alt="–ß—Ç–æ –¥—É–º–∞–µ—Ç–µ –æ —Ä–∞–±–æ—Ç–µ —Å –æ—à–∏–±–∫–∞–º–∏ –≤ Go?" src="go-errors-poll.png"></a>
  <figcaption>–ù–∞–¥–æ –ª–∏ –≤—Å—ë –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –Ω–∞ PHP ü§î</figcaption>
</figure>
</div>
</div>
