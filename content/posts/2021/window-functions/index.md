+++
date = 2021-03-15T09:20:42Z
description = "ะะพะฝััะฝะพะต ะฒะฒะตะดะตะฝะธะต ะฒยยซะพะบะพัะบะธยป ะดะปั ะฒัะตั, ะบัะพ ะฐะฝะฐะปะธะทะธััะตั ะดะฐะฝะฝัะต ะฒยSQL."
featured = true
image = "/window-functions/cover.png"
slug = "window-functions"
tags = ["data", "sqlite"]
title = "ะะบะพะฝะฝัะต ััะฝะบัะธะธ ะฒยะบะฐััะธะฝะบะฐั"
+++

ะะตั ะฑะพะปะตะต ะพะฑะผะฐะฝัะธะฒะพะณะพ ัะฐะทะดะตะปะฐ SQL, ัะตะผ ยซะพะบะพะฝะฝัะต ััะฝะบัะธะธยป. ะะพะณะดะฐ ัะปััะธัั ััะธ ัะปะพะฒะฐ, ะดัะผะฐะตัั ยซะฝะฐะฒะตัะฝะพ, ะฟัะพััะพ ะฟัะธะดัะผะฐะปะธ ะบะฐะบะธะต-ัะพ ะดะพะฟะพะปะฝะธัะตะปัะฝัะต ััะฝะบัะธะธยป.

ะัะปะธ ะฒะบัะฐััะตยโ ะพะบะพะฝะฝัะต ััะฝะบัะธะธ ะฟะพะผะพะณะฐัั ะดะตะปะฐัั ะบะปะฐััะฝัะต ะฐะฝะฐะปะธัะธัะตัะบะธะต ะพััะตัั ะฑะตะท ััะฐััะธั ยซัะบัะตะปัยป. ะฅะพัะธัะต ะฟะพััะธัะฐัั ะฟัะพัะตะฝั ะฟัะพะดะฐะถ ะฟะพยะผะตัััะฐะผ ะพัยะพะฑัะธั ะฟัะพะดะฐะถ ะทะฐยะณะพะด? ะะบะพะฝะฝัะต ััะฝะบัะธะธ. ะะฐะทะดะตะปะธัั ะผะฐัะบะตัะธะฝะณะพะฒัะต ะบะฐะฝะฐะปั ะฝะฐยัััะตะบัะธะฒะฝัะต ะธยะฝะตัััะตะบัะธะฒะฝัะต? ะะบะพะฝะฝัะต ััะฝะบัะธะธ. ะัะฑัะฐัั ัะพะฟ-10 ะบะปะธะตะฝัะพะฒ ะฟะพยะบะฐะถะดะพะผั ัะตะณะผะตะฝัั? ะขะพะถะต ะพะฝะธ.

ะฏยะฟัะพัะธัะฐะป ะฝะตัะบะพะปัะบะพ ะดะตัััะบะพะฒ ััะฐัะตะน ยซะดะปั ะฝะฐัะธะฝะฐััะธัยป, ะบะพัะพััะต ะพะฑัััะฝัะปะธ, ััะพ ัะฐะบะพะต ะพะบะพะฝะฝัะต ััะฝะบัะธะธ. ะัะต ะพะฝะธ ัััะฐะดะฐะปะธ ะพัยะพะดะฝะพะน ะธะทยะดะฒัั ะฟัะพะฑะปะตะผ:

1. ะัะต ะฟะพะฝััะฝะพ, ะฝะพยะพะฟะธัะฐะฝ 1% ะฒะพะทะผะพะถะฝะพััะตะน ยซะพะบะพัะตะบยป.
2. ะะฐะฟะธัะฐะฝะพ ัะฐะบ ัะปะพะถะฝะพ, ััะพ ะตัะปะธยะฑั ัยัะถะต ะฝะตยะทะฝะฐะป ะฟัะตะดะผะตั ะพะฑััะถะดะตะฝะธัยโ ะฝะธัะตะณะพยะฑั ะฝะตยะฟะพะฝัะป.

<div class="row">
<div class="col-xs-12 col-sm-6">
<figure>
  <img alt="ะกะปะพะถะฝะฐ" src="window-wtf.png">
  <figcaption>ะัะปะธ ะฝะตยัะฐะทะพะฑัะฐัััั ะฒยะทะฐะฟัะพัะฐั ัยยซะพะบะพัะบะฐะผะธยป,
ะฒัะณะปัะดัั ะพะฝะธ ะบะฐะบ-ัะพ ัะฐะบ</figcaption>
</figure>
</div>
</div>

ะฅะพัั ะธัะฟัะฐะฒะธัั ัะธััะฐัะธั ะธยะฝะฐะฟะธัะฐัั ะฟะพะฝััะฝะพะต ะธยะฝะฐะณะปัะดะฝะพะต ะฒะฒะตะดะตะฝะธะต ะฒยะพะบะพะฝะฝัะต ััะฝะบัะธะธ. ะะพะฝััะฝะพะต, ะฟะพัะพะผั ััะพ ัยัะผะตั ะดะพัะพะดัะธะฒะพ ะฟะธัะฐัั ะพยัะปะพะถะฝัั ัะตะผะฐั. ะะฐะณะปัะดะฝะพะตยโ ะฟะพัะพะผั ััะพ ะฟะพะดะณะพัะพะฒะธะป ะฝะตัะบะพะปัะบะพ ะดะตัััะบะพะฒ ะบะฐััะธะฝะพะบ ะธยะณะธัะพะบ, ะบะพัะพััะต ะฟะพะผะพะณัั ะฟะพะฝััั ะฑะฐะทะพะฒัะต ะฟัะธะฝัะธะฟั ยซะพะบะพัะตะบยป.

ะะปะฐะฝ ัะฐะบะพะน:

1. ะะฐัะตะผ ะฝัะถะฝั ะพะบะพะฝะฝัะต ััะฝะบัะธะธ (ััะฐ ััะฐััั).
2. [ะะฐะฝะถะธัะพะฒะฐะฝะธะต](/window-ranking/)
3. [ะกะผะตัะตะฝะธะต](/window-offset/)</span>
4. [ะะณัะตะณะฐัะธั](/window-aggregate/)</span>
5. [ะกะบะพะปัะทััะธะต ะฐะณัะตะณะฐัั](/window-rolling/)</span>

ะฏยัะตะบะพะผะตะฝะดัั ะฝะตยะฟัะพััะพ ัะธัะฐัั ััะฐััะธ, ะฐยััะฐะทั <a href="https://stepik.org/z/95367"><strong>ะฟัะพัะพะดะธัั ะบััั</strong></a>. ะยะฝะตะผ ะผะฝะพะณะพ ะฟัะฐะบัะธัะตัะบะธั ะทะฐะดะฐัะตะบ, ะฐยัะพะปัะบะพ ัยะฝะธะผะธ ะฐะฑัััะฐะบัะฝัะต ะทะฝะฐะฝะธั ะฟัะตะฒัะฐััััั ะฒยะฝะฐะฒัะบะธ.

<p class="text-centered">โ&nbsp;โ&nbsp;โ</p>

ะัะฐะบ, ะทะฐัะตะผ ะฝัะถะฝั ะพะบะพะฝะฝัะต ััะฝะบัะธะธ? ะัะพัะต ะฒัะตะณะพ ะพะฑัััะฝััั ะฝะฐยะบะพะฝะบัะตัะฝัั ะฟัะธะผะตัะฐั. ะัะดะตะผ ัะฐะฑะพัะฐัั ัยะธะณัััะตัะฝะพะน ัะฐะฑะปะธัะตะน ัะพัััะดะฝะธะบะพะฒ, ะฒะพั ัะฐะบะพะน:

<div class="row">
<div class="col-xs-12 col-sm-6">
<figure><img alt="ะขะฐะฑะปะธัะฐ ัะพัััะดะฝะธะบะพะฒ" src="window-employees.png"></figure>
</div>
</div>

ะะฐััะผะพััะธะผ ะฝะตะบะพัะพััะต ะทะฐะดะฐัะธ, ะบะพัะพััะต ัะดะพะฑะฝะพ ัะตัะฐัั ัยะฟะพะผะพััั ยซะพะบะพัะตะบยป ะฒยSQL. ะะฐะบ ะธะผะตะฝะฝะพ ะธัยัะตัะฐััยโ ัะฐะทะฑะตัะตะผัั ะฒยัะปะตะดัััะตะน ัะฐััะธ. ะะพะบะฐ ะฟัะพััะพ ะพัะตะฝะธะผ ะฒะพะทะผะพะถะฝะพััะธ.

## 1. ะะฐะฝะถะธัะพะฒะฐะฝะธะต

ะะฐะฝะถะธัะพะฒะฐะฝะธะต โ ััะพ ะฒัะตะฒะพะทะผะพะถะฝัะต ัะตะนัะธะฝะณะธ, ะฝะฐัะธะฝะฐั ะพัยะฟัะธะทะตัะพะฒ ัะตะผะฟะธะพะฝะฐัะฐ ะผะธัะฐ ะฟะพยะฟะปะฐะฒะฐะฝะธั ะธยะทะฐะบะฐะฝัะธะฒะฐั Forbes 500.

ะะฐยะฟัะธะผะตัะต ะฝะฐัะตะน ัะฐะฑะปะธัะบะธ ัะพัััะดะฝะธะบะพะฒ:

**ะะฑัะธะน ัะตะนัะธะฝะณ ะทะฐัะฟะปะฐั**

ะกะพััะฐะฒะธะผ ัะตะนัะธะฝะณ ัะพัััะดะฝะธะบะพะฒ ะฟะพยัะฐะทะผะตัั ะทะฐัะฐะฑะพัะฝะพะน ะฟะปะฐัั:

<div class="row">
<div class="col-xs-12 col-sm-6">
<figure><img alt="ะะฑัะธะน ัะตะนัะธะฝะณ ะทะฐัะฟะปะฐั" src="window-rank.png"></figure>
</div>
</div>

ะะธะดะฝะพ, ััะพ ัยะฝะตะบะพัะพััั ะบะพะปะปะตะณ ะพะดะธะฝะฐะบะพะฒะฐั ะทะฐัะฟะปะฐัะฐ (ะะตะพะฝะธะด ะธยะะฐัะธะฝะฐ, ะะตัะพะฝะธะบะฐ ะธยะัะธะณะพัะธะน) โ ะฟะพััะพะผั ะพะฝะธ ะฟะพะปััะธะปะธ ะพะดะธะฝ ะธยัะพัยะถะต ัะฐะฝะณ.

**ะะตะนัะธะฝะณ ะทะฐัะฟะปะฐั ะฟะพยะดะตะฟะฐััะฐะผะตะฝัะฐะผ**

ะขะพัยะถะต ัะตะนัะธะฝะณ, ัะพะปัะบะพ ะฝะตยะดะปั ะฒัะตะน ะบะพะผะฟะฐะฝะธะธ, ะฐยะฟะพยะบะฐะถะดะพะผั ะดะตะฟะฐััะฐะผะตะฝัั ะฒยะพัะดะตะปัะฝะพััะธ:

<div class="row">
<div class="col-xs-12 col-sm-6">
<figure><img alt="ะะตะนัะธะฝะณ ะทะฐัะฟะปะฐั ะฟะพ ะดะตะฟะฐััะฐะผะตะฝัะฐะผ" src="window-rank-department.png"></figure>
</div>
</div>

**ะััะฟะฟั ะฟะพยะทะฐัะฟะปะฐัะต**

ะะฐะทะพะฑัะตะผ ัะพัััะดะฝะธะบะพะฒ ะฝะฐยััะธ ะณััะฟะฟั ะฒยะทะฐะฒะธัะธะผะพััะธ ะพัยัะฐะทะผะตัะฐ ะทะฐัะฟะปะฐัั:

- ะฒััะพะบะพะพะฟะปะฐัะธะฒะฐะตะผัะต,
- ััะตะดะฝะธะต,
- ะฝะธะทะบะพะพะฟะปะฐัะธะฒะฐะตะผัะต.

<div class="row">
<div class="col-xs-12 col-sm-6">
<figure><img alt="ะััะฟะฟั ะฟะพ ะทะฐัะฟะปะฐัะต" src="window-rank-bucket.png"></figure>
</div>
</div>

**ะกะฐะผัะต ยซะดะพัะพะณะธะตยป ะบะพะปะปะตะณะธ**

ะะฐะนะดะตะผ ัะฐะผัั ะฒััะพะบะพะพะฟะปะฐัะธะฒะฐะตะผัั ะปัะดะตะน ะฟะพยะบะฐะถะดะพะผั ะดะตะฟะฐััะฐะผะตะฝัั:

<div class="row">
<div class="col-xs-12 col-sm-6">
<figure><img alt="ะกะฐะผัะต ยซะดะพัะพะณะธะตยป ะบะพะปะปะตะณะธ" src="window-rank-top.png"></figure>
</div>
</div>

ะงัะพยะถ, ััะธะผ ะทะฐัะฟะปะฐัั ะฑะพะปััะต ะฝะตยะฟะพะฒััะฐัั! (ะธะปะธ ะฝะฐะพะฑะพัะพั, ะฟะพะฒััะธัั? ๐ค)

## 2. ะกัะฐะฒะฝะตะฝะธะต ัะพยัะผะตัะตะฝะธะตะผ

ะกัะฐะฒะฝะตะฝะธะต ัะพยัะผะตัะตะฝะธะตะผ โ ััะพ ะบะพะณะดะฐ ะผัยัะผะพััะธะผ, ะฒยัะตะผ ัะฐะทะฝะธัะฐ ะผะตะถะดั ัะพัะตะดะฝะธะผะธ ะทะฝะฐัะตะฝะธัะผะธ. ะะฐะฟัะธะผะตั, ััะฐะฒะฝะธะฒะฐะตะผ ัััะฐะฝั, ะบะพัะพััะต ะทะฐะฝะธะผะฐัั 5ยะธย6ยะผะตััะพ ะฒยะผะธัะพะฒะพะผ ัะตะนัะธะฝะณะต ะะะ โ ัะธะปัะฝะพยะปะธ ะพัะปะธัะฐัััั? ะยะตัะปะธ ััะฐะฒะฝะธัั 1ยะธย6ยะผะตััะพ?

ะกัะดะฐยะถะต ะฟะพะฟะฐะดะฐัั ะทะฐะดะฐัะธ, ะฒยะบะพัะพััั ะผัยััะฐะฒะฝะธะฒะฐะตะผ ะทะฝะฐัะตะฝะธะต ะธะทยะฝะฐะฑะพัะฐ ัยะณัะฐะฝะธัะฐะผะธ ะฝะฐะฑะพัะฐ. ะะฐะฟัะธะผะตั, ะตััั 100ยะปัััะธั ัะตะฝะฝะธัะธััะพะบ ะผะธัะฐ. ะะฐัะธั ะกะฐะบะบะฐัะธ ะทะฐะฝะธะผะฐะตั ะฒยัะตะนัะธะฝะณะต 20ยะผะตััะพ. ะะฐะบ ะตะตยะฟะพะบะฐะทะฐัะตะปะธ ัะพะพัะฝะพััััั ัยะญัะปะธ ะะฐััะปะธ, ะบะพัะพัะฐั ะทะฐะฝะธะผะฐะตั 1ยะผะตััะพ? ะยัยะะธะฝ ะงะถะพั, ะบะพัะพัะฐั ะทะฐะฝะธะผะฐะตั 100ยะผะตััะพ?

ะะฐยะฟัะธะผะตัะต ะฝะฐัะตะน ัะฐะฑะปะธัะบะธ ัะพัััะดะฝะธะบะพะฒ:

**ะะฐะทะฝะธัะฐ ะฟะพยะทะฐัะฟะปะฐัะต ัยะฟัะตะดัะดััะธะผ**

ะฃะฟะพััะดะพัะธะผ ัะพัััะดะฝะธะบะพะฒ ะฟะพยะฒะพะทัะฐััะฐะฝะธั ะทะฐัะฟะปะฐัั ะธยะฟัะพะฒะตัะธะผ, ะฒะตะปะธะบยะปะธ ัะฐะทััะฒ ะผะตะถะดั ัะพัะตะดัะผะธ:

<div class="row">
<div class="col-xs-12 col-sm-6">
<figure><img alt="ะะฐะทะฝะธัะฐ ะฟะพ ะทะฐัะฟะปะฐัะต ั ะฟัะตะดัะดััะธะผ" src="window-offset-lag.png"></figure>
</div>
</div>

ะกัะพะปะฑะตั `diff` ะฟะพะบะฐะทัะฒะฐะตั, ะฝะฐยัะบะพะปัะบะพ ะฟัะพัะตะฝัะพะฒ ะทะฐัะฟะปะฐัะฐ ัะพัััะดะฝะธะบะฐ ะพัะปะธัะฐะตััั ะพัยะฟัะตะดัะดััะตะณะพ ะบะพะปะปะตะณะธ. ะะธะดะฝะพ, ััะพ ะฑะพะปััะธั ัะฐะทััะฒะพะฒยะฝะตั. ะกะฐะผัะต ะบััะฟะฝัะตยโ ะผะตะถะดั ะะฐััะตะน ะธยะะพัะธัะพะผ (10%) ะธยะะฐัะธะฝะพะน ะธยะะฒะฐะฝะพะผ (13%).

**ะะธะฐะฟะฐะทะพะฝ ะทะฐัะฟะปะฐั ะฒยะดะตะฟะฐััะฐะผะตะฝัะต**

ะะพัะผะพััะธะผ, ะบะฐะบ ะทะฐัะฟะปะฐัะฐ ัะพัััะดะฝะธะบะฐ ัะพะพัะฝะพัะธััั ัยะผะธะฝะธะผะฐะปัะฝะพะน ะธยะผะฐะบัะธะผะฐะปัะฝะพะน ะทะฐัะฟะปะฐัะพะน ะฒยะตะณะพ ะดะตะฟะฐััะฐะผะตะฝัะต:

<div class="row">
<div class="col-xs-12 col-sm-8">
<figure><img alt="ะะธะฐะฟะฐะทะพะฝ ะทะฐัะฟะปะฐั ะฒ ะดะตะฟะฐััะฐะผะตะฝัะต" src="window-offset-first-last.png"></figure>
</div>
</div>

ะะปั ะบะฐะถะดะพะณะพ ัะพัััะดะฝะธะบะฐ ััะพะปะฑะตั `low` ะฟะพะบะฐะทัะฒะฐะตั ะผะธะฝะธะผะฐะปัะฝัั ะทะฐัะฟะปะฐัั ัะพะดะฝะพะณะพ ะดะตะฟะฐััะฐะผะตะฝัะฐ, ะฐยััะพะปะฑะตั `high`ยโ ะผะฐะบัะธะผะฐะปัะฝัั. ะะธะดะฝะพ, ััะพ ัะฐะทะฑัะพั ะทะฝะฐัะตะฝะธะน ะฒยHRยะธยะฟัะพะดะฐะถะฐั ะฝะตะฒะตะปะธะบ, ะฐยัยะฐะนัะธัะฝะธะบะพะฒยโ ะทะฝะฐัะธัะตะปัะฝัะน.

## 3. ะะณัะตะณะฐัะธั

ะะณัะตะณะฐัะธั โ ััะพ ะบะพะณะดะฐ ะผัยััะธัะฐะตะผ ััะผะผะฐัะฝัะต ะธะปะธ ััะตะดะฝะธะต ะฟะพะบะฐะทะฐัะตะปะธ. ะะฐะฟัะธะผะตั, ััะตะดะฝัั ะทะฐัะฟะปะฐัั ะฟะพยะบะฐะถะดะพะผั ัะตะณะธะพะฝั ะธะปะธ ะบะพะปะธัะตััะฒะพ ะทะพะปะพััั ะผะตะดะฐะปะตะน ัยะบะฐะถะดะพะน ัััะฐะฝั ะฒยะทะฐัะตัะต ะะปะธะผะฟะธะนัะบะธั ะธะณั.

ะะฐยะฟัะธะผะตัะต ะฝะฐัะตะน ัะฐะฑะปะธัะบะธ ัะพัััะดะฝะธะบะพะฒ:

**ะกัะฐะฒะฝะตะฝะธะต ัยัะพะฝะดะพะผ ะพะฟะปะฐัั ัััะดะฐ**

ะฃยะบะฐะถะดะพะณะพ ะดะตะฟะฐััะฐะผะตะฝัะฐ ะตััั ัะพะฝะด ะพะฟะปะฐัั ัััะดะฐยโ ะดะตะฝะตะถะฝะฐั ััะผะผะฐ, ะบะพัะพัะฐั ะตะถะตะผะตัััะฝะพ ััะพะดะธั ะฝะฐยะฒัะฟะปะฐัั ะทะฐัะฟะปะฐั ัะพัััะดะฝะธะบะฐะผ. ะะพัะผะพััะธะผ, ะบะฐะบะพะน ะฟัะพัะตะฝั ะพัยััะพะณะพ ัะพะฝะดะฐ ัะพััะฐะฒะปัะตั ะทะฐัะฟะปะฐัะฐ ะบะฐะถะดะพะณะพ ัะพัััะดะฝะธะบะฐ:

<div class="row">
<div class="col-xs-12 col-sm-7">
<figure><img alt="ะกัะฐะฒะฝะตะฝะธะต ั ัะพะฝะดะพะผ ะพะฟะปะฐัั ัััะดะฐ" src="window-aggregate-sum.png"></figure>
</div>
</div>

ะกัะพะปะฑะตั `fund` ะฟะพะบะฐะทัะฒะฐะตั ัะพะฝะด ะพะฟะปะฐัั ัััะดะฐ ะพัะดะตะปะฐ, ะฐย`perc`ยโ ะดะพะปั ะทะฐัะฟะปะฐัั ัะพัััะดะฝะธะบะฐ ะพัยััะพะณะพ ัะพะฝะดะฐ. ะะธะดะฝะพ, ััะพ ะฒยHRยะธยะฟัะพะดะฐะถะฐั ะฒัะต ะฑะพะปะตะต-ะผะตะฝะตะต ัะพะฒะฝะพ, ะฐยัยะฐะนัะธัะฝะธะบะพะฒ ะตััั ะทะฐะผะตัะฝัะน ัะฐะทะฑัะพั ะทะฐัะฟะปะฐั.

**ะกัะฐะฒะฝะตะฝะธะต ัะพยััะตะดะฝะตะน ะทะฐัะฟะปะฐัะพะน**

ะะฝัะตัะตัะฝะพ, ะฒะตะปะธะบยะปะธ ัะฐะทะฑัะพั ะทะฐัะฟะปะฐั ะฒยะดะตะฟะฐััะฐะผะตะฝัะฐั. ะัะพะฒะตัะธะผ: ะฟะพััะธัะฐะตะผ ะพัะบะปะพะฝะตะฝะธะต ะทะฐัะฟะปะฐัั ะบะฐะถะดะพะณะพ ัะพัััะดะฝะธะบะฐ ะพัยััะตะดะฝะตะน ะฟะพยะดะตะฟะฐััะฐะผะตะฝัั:

<div class="row">
<div class="col-xs-12 col-sm-8">
<figure><img alt="ะกัะฐะฒะฝะตะฝะธะต ัะพ ััะตะดะฝะตะน ะทะฐัะฟะปะฐัะพะน" src="window-aggregate-diff.png"></figure>
</div>
</div>

ะะตะทัะปััะฐั ะฟะพะดัะฒะตัะถะดะฐะตั ะฟัะตะดัะดััะธะต ะฝะฐะฑะปัะดะตะฝะธั: ัยะฐะนัะธัะฝะธะบะพะฒ ะทะฐัะฟะปะฐัั ะบะพะปะตะฑะปัััั ะพัย-16% ะดะพย+20% ะพัยััะตะดะฝะตะณะพ, ะฐยัยะพััะฐะปัะฝัั ะดะตะฟะฐััะฐะผะตะฝัะพะฒ ะพัะบะปะพะฝะตะฝะธะต ะฒยะฟัะตะดะตะปะฐัย5%.

## 4. ะกะบะพะปัะทััะธะต ะฐะณัะตะณะฐัั

ะกะบะพะปัะทััะธะต ะฐะณัะตะณะฐัั โ ััะพ ัะตยะถะต ััะผะผะฐ ะธยััะตะดะฝะตะต. ะขะพะปัะบะพ ัะฐัััะธััะฒะฐัั ะธัยะฝะตยะฟะพยะฒัะตะผ ัะปะตะผะตะฝัะฐะผ ะฝะฐะฑะพัะฐ, ะฐยะฑะพะปะตะต ัะธัััะผ ัะฟะพัะพะฑะพะผ.

ะะพััะฝั ะฝะฐยะฟัะธะผะตัะต. ะะดะตัั ะฒะพะทัะผะตะผ ะดััะณัั ัะฐะฑะปะธัะบั โ ัยะดะพัะพะดะฐะผะธ ะธยัะฐััะพะดะฐะผะธ ะพะดะฝะพะณะพ ะธะทยัะพัััะดะฝะธะบะพะฒ (ะฟัััั ััะพ ะฑัะดะตั ะะฐัะธะฝะฐ) ะทะฐย9ยะผะตัััะตะฒ 2020ยะณะพะดะฐ:

<div class="row">
<div class="col-xs-12 col-sm-6">
<figure><img alt="ะขะฐะฑะปะธัะฐ ัะฐััะพะดะพะฒ" src="window-expenses.png"></figure>
</div>
</div>

**ะกะบะพะปัะทััะตะต ััะตะดะฝะตะต ะฟะพยัะฐััะพะดะฐะผ**

ะกัะดั ะฟะพยะดะฐะฝะฝัะผ, ะดะพัะพะดั ัยะะฐัะธะฝั ัะฐัััั: 94ะยโฝ ะฒยัะฝะฒะฐัะต โ 104ะยโฝ ะฒยัะตะฝััะฑัะต. ะยะฒะพั ัะฐััััยะปะธ ัะฐััะพะดั? ะกัะพะดั ัะปะพะถะฝะพ ัะบะฐะทะฐัั, ะผะตััั ะฝะฐยะผะตััั ะฝะตยะฟัะธัะพะดะธััั. ะงัะพะฑั ัะณะปะฐะดะธัั ััะธ ัะบะฐัะบะธ, ะธัะฟะพะปัะทััั ยซัะบะพะปัะทััะตะต ััะตะดะฝะตะตยป โ ะดะปั ะบะฐะถะดะพะณะพ ะผะตัััะฐ ัะฐัััะธััะฒะฐัั ััะตะดะฝะธะน ัะฐััะพะด ัยััะตัะพะผ ะฟัะตะดัะดััะตะณะพ ะธยัะปะตะดัััะตะณะพ ะผะตัััะฐ. ะะฐะฟัะธะผะตั:

- ัะบะพะปัะทััะตะต ััะตะดะฝะตะต ะทะฐยัะตะฒัะฐะปั = (ัะฝะฒะฐัั + ัะตะฒัะฐะปั + ะผะฐัั) / 3;
- ะทะฐยะผะฐัั = (ัะตะฒัะฐะปั + ะผะฐัั + ะฐะฟัะตะปั) / 3;
- ะทะฐยะฐะฟัะตะปั = (ะผะฐัั + ะฐะฟัะตะปั + ะผะฐะน) / 3;
- ะธยัะฐะบ ะดะฐะปะตะต.

ะะฐัััะธัะฐะตะผ ัะบะพะปัะทััะตะต ััะตะดะฝะตะต ะฟะพยะฒัะตะผ ะผะตัััะฐะผ:

<div class="row">
<div class="col-xs-12 col-sm-6">
<figure><img alt="ะกะบะพะปัะทััะตะต ััะตะดะฝะตะต ะฟะพ ัะฐััะพะดะฐะผ" src="window-rolling-avg.png"></figure>
</div>
</div>

ะขะตะฟะตัั ัะพัะพัะพ ะฒะธะดะฝะพ, ััะพ ัะฐััะพะดั ััะฐะฑะธะปัะฝะพ ัะฐัััั.

**ะัะธะฑัะปั ะฝะฐัะฐััะฐััะธะผ ะธัะพะณะพะผ**

ะัยะฒัััะฝะธะปะธ, ััะพ ัะฐัััั ะธยะดะพัะพะดั, ะธยัะฐััะพะดั. ะยะบะฐะบ ะพะฝะธ ัะพะพัะฝะพััััั ะดััะณ ัยะดััะณะพะผ? ะฅะพัะตััั ะฟะพะฝััั, ะฝะฐัะพะดะธัััยะปะธ ัะตะปะพะฒะตะบ ยซะฒยะฟะปััะตยป ะธะปะธ ยซะฒยะผะธะฝััะตยป ัยััะตัะพะผ ะฒัะตั ะทะฐัะฐะฑะพัะฐะฝะฝัั ะธยะฟะพััะฐัะตะฝะฝัั ะดะตะฝะตะณ.

ะัะธัะตะผ ะฒะฐะถะฝะพ ะฟะพะฝะธะผะฐัั ะฝะตยะฝะฐยะบะพะฝะตั ะณะพะดะฐ, ะฐยะฝะฐยะบะฐะถะดัะน ะผะตััั. ะะพัะพะผั ััะพ ะตัะปะธ ะฟะพยะธัะพะณะฐะผ ะณะพะดะฐ ัยะะฐัะธะฝั ะฒัะต ะะ, ะฐยะฒยะธัะฝะต ััะปะฐ ะฒยะผะธะฝัั โ ััะพ ะฟะพัะตะฝัะธะฐะปัะฝะฐั ะฟัะพะฑะปะตะผะฐ (ัยะบะพะผะฟะฐะฝะธะน ัะฐะบัั ัะธััะฐัะธั ะฝะฐะทัะฒะฐัั ยซะบะฐััะพะฒัะผ ัะฐะทััะฒะพะผยป).

ะะพััะพะผั ะฟะพััะธัะฐะตะผ ะดะพัะพะดั ะธยัะฐััะพะดั ะฟะพยะผะตัััะฐะผ ะฝะฐัะฐััะฐััะธะผ ะธัะพะณะพะผ (ะบัะผัะปััะธะฒะฝะพ):

- ะบัะผัะปััะธะฒะฝัะน ะดะพัะพะด ะทะฐยัะฝะฒะฐัั = ัะฝะฒะฐัั;
- ะทะฐยัะตะฒัะฐะปั = ัะฝะฒะฐัั + ัะตะฒัะฐะปั;
- ะทะฐยะผะฐัั = ัะฝะฒะฐัั + ัะตะฒัะฐะปั + ะผะฐัั;
- ะทะฐยะฐะฟัะตะปั = ัะฝะฒะฐัั + ัะตะฒัะฐะปั + ะผะฐัั + ะฐะฟัะตะปั;
- ะธยัะฐะบ ะดะฐะปะตะต.

<div class="row">
<div class="col-xs-12 col-sm-10">
<figure><img alt="ะัะธะฑัะปั ะฝะฐัะฐััะฐััะธะผ ะธัะพะณะพะผ" src="window-cumulative-sum.png"></figure>
</div>
</div>

ะขะตะฟะตัั ะฒะธะดะฝะพ, ััะพ ะดะตะปะฐ ัยะะฐัะธะฝั ะธะดัั ะฝะตะฟะปะพัะพ. ะยะฝะตะบะพัะพััั ะผะตัััะฐั ัะฐััะพะดั ะฟัะตะฒััะฐัั ะดะพัะพะดั, ะฝะพยะฑะปะฐะณะพะดะฐัั ะฝะฐะบะพะฟะปะตะฝะฝะพะน ยซะดะตะฝะตะถะฝะพะน ะฟะพะดััะบะตยป ะบะฐััะพะฒะพะณะพ ัะฐะทััะฒะฐ ะฝะตยะฟัะพะธััะพะดะธั.

## ะะตะทัะผะต

ะะพั ะทะฐะดะฐัะธ, ะบะพัะพััะต ะฝะตะฟัะธะฝัะถะดะตะฝะฝะพ ัะตัะฐัััั ัยะฟะพะผะพััั ะพะบะพะฝะฝัั ััะฝะบัะธะน ะฒยSQL:

1. ะะฐะฝะถะธัะพะฒะฐะฝะธะต (ะฒัะตะฒะพะทะผะพะถะฝัะต ัะตะนัะธะฝะณะธ).
2. ะกัะฐะฒะฝะตะฝะธะต ัะพยัะผะตัะตะฝะธะตะผ (ัะพัะตะดะฝะธะต ัะปะตะผะตะฝัั ะธยะณัะฐะฝะธัั).
3. ะะณัะตะณะฐัะธั (ััะผะผะฐ ะธยััะตะดะฝะตะต).
4. ะกะบะพะปัะทััะธะต ะฐะณัะตะณะฐัั (ััะผะผะฐ ะธยััะตะดะฝะตะต ะฒยะดะธะฝะฐะผะธะบะต).

ะะพะฝะตัะฝะพ, ััะพ ะฝะตยะธััะตัะฟัะฒะฐััะธะน ัะฟะธัะพะบ. ะะพ, ะฝะฐะดะตััั, ัะตะฟะตัั ะฟะพะฝััะฝะพ, ะบะฐะบยะฟัะธะณะพะดัััั ะพะบะพะฝะฝัะต ััะฝะบัะธะธ ะฒยะฐะฝะฐะปะธัะธะบะต ะดะฐะฝะฝัั. ะย[ัะปะตะดัััะตะน ัะฐััะธ](/window-ranking/) ัะฐะทะฑะตัะตะผัั, ััะพ ัะฐะบะพะต ยซะพะบะฝะพยป ะธยะบะฐะบ ัะฐะฑะพัะฐะตั ะพะบะพะฝะฝะฐั ััะฝะบัะธั.

ะงัะพะฑั ะทะฐะบัะตะฟะธัั ะทะฝะฐะฝะธั ะฝะฐยะฟัะฐะบัะธะบะต โ <a href="https://stepik.org/z/95367"><strong>ะทะฐะฟะธััะฒะฐะนัะตัั ะฝะฐยะบััั</strong></a>ย๐



